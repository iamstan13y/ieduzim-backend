<form nz-form [formGroup]="validateForm" [ngClass]="{'mt-3': !form.title}">
    <h4 class="mb-4" *ngIf="form.title">{{form.title}}</h4>
    <div class="row">
    <nz-form-item *ngFor="let field of fields; let i = index" class="{{field.col ? field.col : 'col-12'}}">
        <nz-form-label class="mb-0" [nzFor]="field.name">
            {{field.label}}
        </nz-form-label>
        <nz-form-control nzErrorTip="{{getError(field)}}">
            <nz-input-group nzPrefixIcon="{{(field.type == 6 || field.type == 7 || field.type == 13 || field.type == 9) ? '' : field.icon ? field.icon : 'edit'}}">

                <input *ngIf="!field.type || field.type < 5" type="{{getFieldType(field)}}" nz-input min = "{{field.type == 2 ? 0: ''}}"
                    [formControlName]="field.name" placeholder="Enter {{field.label}}" />

                <textarea *ngIf="field.type == 5" rows="3" nz-input [formControlName]="field.name"
                    placeholder="Enter {{field.label}}"></textarea>

                <nz-select [nzDropdownRender]="render" class="d-block"
                    nzPlaceHolder="Select {{field.label}}" *ngIf="field.type == 6 && !field.subSelection"
                    [formControlName]="field.name">
                    <span *ngIf="field.options.pageResult">
                        <nz-option *ngFor="let group of field.options.pageResult.data" [nzLabel]="group[field.options.name]"
                            [nzValue]="group[field.options.value]">
                        </nz-option>
                    </span>
                </nz-select>

                <ng-template #render>
                    <div class="col-12 text-right p-2">
                        <button *ngIf="field.options && field.options.pageRequest && !field.options.pageRequest.last && field.options.pageResult.data.length > 0" 
                            nz-button nzType="primary" (click)="loadMoreOptions(field)"><i nz-icon
                                nzType="vertical-align-bottom" nzTheme="outline"></i> Load More</button>
                        <button *ngIf="field.options && field.options.pageRequest && ( field.options.pageRequest.last || field.options.pageRequest.pageNumber > 1) && field.options.pageResult.data.length > 0" 
                            nz-button nzType="primary" nzGhost (click)="loadPreviousOptions(field)"><i nz-icon
                                nzType="vertical-align-top" nzTheme="outline"></i> Load Prev</button>
                    </div>
                </ng-template>

                <select class="form-control pl-4" *ngIf="field.type == 6 && field.subSelection"
                    [(ngModel)]="field.value" [formControlName]="field.name">
                    <option disabled value="0">Select {{field.label}}</option>
                    <optgroup label="{{group.name}}" *ngFor="let group of field.options.data">
                        <option *ngFor="let item of group[field.subSelection]" [ngValue]="item.id">{{item.name}}
                        </option>
                    </optgroup>
                </select>
                <nz-month-picker *ngIf="field.type == 11" [formControlName]="field.name" [nzFormat]="'MM/yyyy'">
                </nz-month-picker>

                <nz-date-picker *ngIf="field.type == 7" [formControlName]="field.name"></nz-date-picker>

                <nz-upload *ngIf="field.type == 8" nzAction="https://jsonplaceholder.typicode.com/posts/">
                    <button nz-button><i nz-icon nzType="upload"></i><span>Click to Upload</span></button>
                </nz-upload>

                <nz-switch *ngIf="field.type == 9" [formControlName]="field.name"></nz-switch>
                <nz-rate *ngIf="field.type == 13" [formControlName]="field.name"></nz-rate><br />
            </nz-input-group>
        </nz-form-control>
    </nz-form-item>
    </div>
    <nz-form-item class="mb-0 mt-3">
        <nz-form-control class="text-right">
            <nz-button-group>
            <button nz-button nzType="{{item.class ? item.class : 'default'}}" *ngFor="let item of form.buttons"
                (click)="click(item)">{{item.name}}</button>
            </nz-button-group>
        </nz-form-control>
    </nz-form-item>
</form>